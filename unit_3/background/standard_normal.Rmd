---
title: "R Notebook"
output: html_notebook
---

### Background

The [standard normal random variable](https://en.wikipedia.org/wiki/Normal_distribution#Standard_normal_distribution){target="blank"} has a population mean $\mu=0$ and population standard deviation $\sigma=1$. The density curve is precisely defined as an exponential of a squared distance from the population mean. 

$$\text{standard normal density}=\frac{1}{\sqrt{2\pi}}e^{-{\frac{1}{2}}z^{2}}$$

where [$\pi\approx 3.14$](https://en.wikipedia.org/wiki/Pi){target="blank"} and [$e\approx 2.718$](https://en.wikipedia.org/wiki/E_(mathematical_constant)){target="blank"}.
We can visualize this continuous random variable with a [density curve](https://en.wikipedia.org/wiki/Probability_density_function){target="blank"}, a [cumulative curve](https://en.wikipedia.org/wiki/Cumulative_distribution_function){target="blank"}, or a spinner.

```{r echo=F,fig.width=6,fig.height=3}
par(mar=c(5,5,0,0))
z2 = seq(-3,3,0.01)
yl = seq(0,0.4,0.05)
zl = seq(-3,3,0.2)
plot(z2,dnorm(z2),type="l",axes=F,ylab="probability density",xlab="z",lwd=4,ylim=c(0,0.5))
axis(1,at=(-3):3)
abline(h=0)
for(z2 in zl){
  lines(c(z2,z2),c(0,0.4),lty=2,col=rgb(0.5,0.5,0.5))
}
for(y in yl){
  lines(c(-3,3),c(y,y),lty=2,col=rgb(0.5,0.5,0.5))
}
```
\
```{r echo=F,fig.width=6,fig.height=9}
z2 = seq(-3,3,length.out=1000)
p = pnorm(z2)
plot(z2,p,type="l",lwd=2,ylab="cumulative probability P[Z<z]",xlab="z",axes=F,ylim=c(0,1))
axis(1,at=seq(-3,3,1))
axis(3,at=seq(-3,3,1))
axis(2,at=seq(0,1,0.1))
axis(4,at=seq(0,1,0.1))
abline(v=seq(-3,3,.1),col=rgb(0.7,0.7,0.7))
abline(h=0:100/100,col=rgb(0.7,0.7,0.7))
abline(h=0:20/20,col=rgb(0.5,0.5,0.5))
abline(h=0:10/10,col=rgb(0.3,0.3,0.3))
abline(v=seq(-3,3,1),col=rgb(0.3,0.3,0.3))
lines(z2,pnorm(z2),lwd=3)

adjx = c(0,0,0,0,1,1,0.9)
adjy = c(1.2,0.8,0.5,1,0.5,0.3,-0.3)

```
\

```{r echo=F,fig.width=6,fig.height=6}
par(mar=c(0,0,0,0))
theta=seq(0,2*pi,length.out=1000)
plot(sin(theta),cos(theta),type="l",ann=F,axes=F,xlim=c(-1.2,1.2),ylim=c(-1.2,1.2))
zs = -3:3
for(i in 1:length(zs)){
  p = pnorm(zs[i])
  lines(sin(p*2*pi)*c(0.8,1),cos(p*2*pi)*c(0.8,1),lwd=2)
  pt = min(max(p,0.007),0.993)
  text(0.75*sin(pt*2*pi),0.75*cos(pt*2*pi),zs[i])
}
zs = seq(-2.5,2.5,1)
for(i in 1:length(zs)){
  p = pnorm(zs[i])
  lines(sin(p*2*pi)*c(0.85,1),cos(p*2*pi)*c(0.85,1),lwd=2)
}
zs = seq(-3,3,0.1)
for(i in 1:length(zs)){
  p = pnorm(zs[i])
  lines(sin(p*2*pi)*c(0.9,1),cos(p*2*pi)*c(0.9,1),lwd=1)
}
zs = seq(-2,2,0.1)
for(i in 1:length(zs)){
  p = pnorm(zs[i])
  if(zs[i]%%0.5 != 0){
    text(sin(p*2*pi)*0.85,cos(p*2*pi)*0.85,cex=0.5,round(zs[i],2),srt=(180-360*p)%%180-90)
  }
}
zs = seq(-3,3,0.05)
for(i in 1:length(zs)){
  p = pnorm(zs[i])
  lines(sin(p*2*pi)*c(0.95,1),cos(p*2*pi)*c(0.95,1))
}
zs = seq(-3,3,0.01)
for(i in 1:length(zs)){
  p = pnorm(zs[i])
  lines(sin(p*2*pi)*c(0.98,1),cos(p*2*pi)*c(0.98,1))
}

for(p in seq(0.1,0.9,0.1)){
  lines(sin(p*2*pi)*c(1,1.05),cos(p*2*pi)*c(1,1.05))
  text(sin(p*2*pi)*1.1,cos(p*2*pi)*1.1,p,cex=0.8,srt=-(p*360-90)%%180-90)
}
for(p in seq(0.01,0.99,0.01)){
  lines(sin(p*2*pi)*c(1,1.03),cos(p*2*pi)*c(1,1.03))
}
for(p in seq(0.002,0.998,0.002)){
  lines(sin(p*2*pi)*c(1,1.01),cos(p*2*pi)*c(1,1.01))
}
lines(c(0,0),c(1,1.05),lwd=2)
text(0,1.09,"1 or 0",cex=0.8)
text(0,0,cex=1.5,"z")
text(0.9,0.9,cex=1.5,"P[Z<z]")
```
\


Often, the relationship between $z$ and the cumulative probability is given in [a z table](https://en.wikipedia.org/wiki/Standard_normal_table#Cumulative){target="blank"}. In spreadsheets, you can use the `NORM.DIST()` function. In R, you can use the `pnorm()` function.





